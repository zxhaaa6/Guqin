#!/usr/bin/env node

const fs = require('fs');
const log4js = require('log4js');
const config = require('../config/config');
const App = require('../app');

// ===================== log module =========================
let hasLogDir = fs.existsSync(__dirname + "/../logs");
if (!hasLogDir) {
    fs.mkdirSync(__dirname + "/../logs");
}

if (config.log4js.logging) {
    log4js.configure(__dirname + "/../config/log4js.json", {
        cwd: __dirname + "/../"
    });
}
// ==================== log module =========================

const log = log4js.getLogger('www');

async function startUp() {
    const app = new App();
    app.startUpHttpServer();
}

startUp().catch(err => {
    log.error(err);
    log.error("Fatal error was encountered. Guqin service cannot started.");
    process.exit(0);
})